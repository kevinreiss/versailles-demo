!function(e,i,t){"use strict";function r(e,i){var t=new XMLHttpRequest;t.overrideMimeType("application/json"),t.open("GET",e,!0),t.onreadystatechange=function(){4==t.readyState&&"200"==t.status&&i(t.responseText)},t.send(null)}function a(e,i){var t=e.properties.field_image_id,r="",a=e.properties.rotation||0,n=e.properties.name||"",o=s+e.properties.nid,l="";l=0!==a?"full/,"+p+"/"+a+"/native.jpg":"full/"+p+",/"+a+"/native.jpg",t&&(r=t.replace(new RegExp("(.*/)[^/]+$"),"$1")+l);var u='<div style="width:'+p+'px;""><a class="popup" href='+o+'><h3 class="popup-text">'+n+"</h3><img src="+r+"></a></div>";i.bindPopup(u,{minWidth:p})}function n(){r(l,function(e){var i=JSON.parse(e),r=t.geoJson(i,{style:function(e){return e.properties&&e.properties.style},onEachFeature:a}),n=t.markerClusterGroup({spiderfyDistanceMultiplier:3,showCoverageOnHover:!1});n.addLayer(r),u.addLayer(n)})}t.Icon.Default.imagePath="images/";var s="/versailles/item/",o="http://libimages.princeton.edu/loris2/exhibits%2FVersailles%2Fversailles_13%2FImage00120_vert.jp2/info.json",p=250,l="/versailles/map.json",u=t.map("map",{center:[0,0],crs:t.CRS.Simple,zoom:0}),d=t.tileLayer.iiif(o,{}).addTo(u);d.on("load",n)}(window,document,L);